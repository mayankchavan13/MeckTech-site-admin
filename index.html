<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>MeckTech Admin Panel</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
  <style>
    body {
      background: #0d1117;
      color: #f0f6fc;
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    h2 { color: #58a6ff; }
    input, select, button, textarea {
      width: 100%;
      padding: 10px;
      margin: 8px 0;
      background: #161b22;
      border: 1px solid #30363d;
      color: #f0f6fc;
      border-radius: 5px;
    }
    button {
      background-color: #238636;
      cursor: pointer;
      border: none;
    }
    .question-box {
      background: #161b22;
      padding: 15px;
      margin-top: 10px;
      border-radius: 8px;
    }
    .question-box button {
      background-color: #da3633;
      margin-right: 5px;
    }
    .edit-btn {
      background-color: #d29922;
    }
  </style>
</head>
<body>

  <h1>⚙️ MeckTech Admin Panel</h1>

  <h2>Branding</h2>
  <input type="text" id="companyName" placeholder="Enter Company Name">
  <input type="text" id="logoURL" placeholder="Enter Logo Image URL">
  <button onclick="saveBranding()">Save Branding</button>

  <h2>Set Certificate Price</h2>
  <input type="number" id="originalPrice" placeholder="Original Price (e.g. 249)">
  <input type="number" id="discountPrice" placeholder="Discounted Price (e.g. 149)">
  <button onclick="savePrice()">Save Price</button>

  <h2>Add New Question</h2>
  <input type="text" id="questionText" placeholder="Question">
  <input type="text" id="opt1" placeholder="Option 1">
  <input type="text" id="opt2" placeholder="Option 2">
  <input type="text" id="opt3" placeholder="Option 3">
  <input type="text" id="opt4" placeholder="Option 4">
  <select id="correctAnswer">
    <option value="">Select Correct Answer</option>
    <option value="0">Option 1</option>
    <option value="1">Option 2</option>
    <option value="2">Option 3</option>
    <option value="3">Option 4</option>
  </select>
  <button onclick="addQuestion()">Add Question</button>

  <h2>Saved Questions</h2>
  <div id="questionList"></div>

  <h2>Paid Users</h2>
  <div id="paidUsers"></div>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDg6hedgJB7nK3xVvIrxg04ouFVTkIHe2k",
      authDomain: "mecktech-bbc2e.firebaseapp.com",
      databaseURL: "https://mecktech-bbc2e-default-rtdb.firebaseio.com",
      projectId: "mecktech-bbc2e",
      storageBucket: "mecktech-bbc2e.appspot.com",
      messagingSenderId: "790927325648",
      appId: "1:790927325648:web:9135f13e7dafba1f0b21d5"
    };

    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Save branding
    function saveBranding() {
      const name = document.getElementById("companyName").value.trim();
      const logo = document.getElementById("logoURL").value.trim();
      if (name && logo) {
        db.ref("branding").set({ name, logo });
        alert("Branding updated!");
      } else {
        alert("Please fill both name and logo URL.");
      }
    }

    // Save price
    function savePrice() {
      const original = document.getElementById("originalPrice").value.trim();
      const discount = document.getElementById("discountPrice").value.trim();
      if (original && discount) {
        db.ref("price").set({ original, discount });
        alert("Price updated!");
      } else {
        alert("Please enter both prices.");
      }
    }

    // Add new question
    function addQuestion() {
      const text = document.getElementById("questionText").value.trim();
      const options = [
        document.getElementById("opt1").value.trim(),
        document.getElementById("opt2").value.trim(),
        document.getElementById("opt3").value.trim(),
        document.getElementById("opt4").value.trim()
      ];
      const correct = document.getElementById("correctAnswer").value;

      if (text && options.every(o => o) && correct !== "") {
        db.ref("questions").push({ text, options, correct });
        alert("Question added!");
        clearForm();
        loadQuestions();
      } else {
        alert("Please fill all fields and select the correct answer.");
      }
    }

    // Clear question form
    function clearForm() {
      document.getElementById("questionText").value = "";
      document.getElementById("opt1").value = "";
      document.getElementById("opt2").value = "";
      document.getElementById("opt3").value = "";
      document.getElementById("opt4").value = "";
      document.getElementById("correctAnswer").value = "";
    }

    // Load and render questions
    function loadQuestions() {
      db.ref("questions").once("value", snap => {
        const container = document.getElementById("questionList");
        container.innerHTML = "";
        const data = snap.val();
        if (!data) return;
        Object.entries(data).forEach(([id, q]) => {
          const div = document.createElement("div");
          div.className = "question-box";
          div.innerHTML = `
            <b>${q.text}</b>
            <ol>
              ${q.options.map((opt, i) => `
                <li${i == q.correct ? ' style="color:#58a6ff;"' : ''}>${opt}</li>
              `).join("")}
            </ol>
            <button onclick="deleteQuestion('${id}')">Delete</button>
          `;
          container.appendChild(div);
        });
      });
    }

    function deleteQuestion(id) {
      if (confirm("Are you sure you want to delete this question?")) {
        db.ref("questions/" + id).remove();
        loadQuestions();
      }
    }

    // Load paid users
    function loadPaidUsers() {
      db.ref("paid_users").once("value", snap => {
        const users = snap.val();
        const div = document.getElementById("paidUsers");
        div.innerHTML = "";
        if (!users) return;
        Object.values(users).forEach(user => {
          div.innerHTML += `<p>${user.name} (${user.email}) - Score: ${user.score}</p>`;
        });
      });
    }

    // Initial loads
    loadQuestions();
    loadPaidUsers();
  </script>

</body>
</html>
