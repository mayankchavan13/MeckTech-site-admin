<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <title>MeckTech Admin Panel</title>
  <style>
    body {
      background-color: #111;
      color: #eee;
      font-family: 'Segoe UI', sans-serif;
      padding: 30px;
    }
    input, select, button {
      padding: 10px;
      margin: 5px;
      border-radius: 6px;
      border: none;
      font-size: 16px;
    }
    .section {
      margin-bottom: 30px;
      background: #1d1d1d;
      padding: 20px;
      border-radius: 10px;
    }
    h2 {
      color: #00ff9d;
    }
    table {
      width: 100%;
      background: #222;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      padding: 10px;
      border: 1px solid #444;
    }
    .btn-danger {
      background-color: #dc3545;
      color: white;
    }
  </style>
</head>
<body>

  <h1>üîê MeckTech Admin Panel</h1>

  <div id="loginBox">
    <input type="email" id="adminEmail" placeholder="Admin Email" />
    <input type="password" id="adminPass" placeholder="Password" />
    <button onclick="adminLogin()">Login</button>
  </div>

  <div id="adminPanel" style="display:none;">
    
    <div class="section">
      <h2>üè∑Ô∏è Branding</h2>
      <input id="companyName" placeholder="Company Name" />
      <button onclick="saveBranding()">Save Branding</button>
    </div>

    <div class="section">
      <h2>üí∞ Certificate Price</h2>
      ‚Çπ <input type="number" id="priceInput" />
      <button onclick="savePrice()">Update Price</button>
    </div>

    <div class="section">
      <h2>‚ùì Manage Questions</h2>
      <input id="qText" placeholder="Question Text" style="width:80%;" /><br>
      <input id="opt1" placeholder="Option 1" />
      <input id="opt2" placeholder="Option 2" />
      <input id="opt3" placeholder="Option 3" />
      <input id="opt4" placeholder="Option 4" /><br>
      Correct: 
      <select id="correctOpt">
        <option value="0">Option 1</option>
        <option value="1">Option 2</option>
        <option value="2">Option 3</option>
        <option value="3">Option 4</option>
      </select>
      <button onclick="addQuestion()">Add Question</button>
      <ul id="questionList"></ul>
    </div>

    <div class="section">
      <h2>üìú Users Who Took Assessment</h2>
      <table id="userTable">
        <thead><tr><th>Name</th><th>Email</th><th>Score</th><th>Delete</th></tr></thead>
        <tbody></tbody>
      </table>
    </div>

  </div>

  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyDg6hedgJB7nK3xVvIrxg04ouFVTkIHe2k",
      authDomain: "mecktech-bbc2e.firebaseapp.com",
      databaseURL: "https://mecktech-bbc2e-default-rtdb.firebaseio.com",
      projectId: "mecktech-bbc2e",
      storageBucket: "mecktech-bbc2e.appspot.com",
      messagingSenderId: "790927325648",
      appId: "1:790927325648:web:9135f13e7dafba1f0b21d5"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    const ADMIN_EMAIL = "mayankc0206@gmail.com";
    const ADMIN_PASS = "Unni@MeckTech13";

    function adminLogin() {
      const email = document.getElementById("adminEmail").value;
      const pass = document.getElementById("adminPass").value;
      if (email === ADMIN_EMAIL && pass === ADMIN_PASS) {
        document.getElementById("loginBox").style.display = "none";
        document.getElementById("adminPanel").style.display = "block";
        loadQuestions();
        loadUsers();
        loadBranding();
        loadPrice();
      } else {
        alert("Invalid admin login.");
      }
    }

    function saveBranding() {
      const name = document.getElementById("companyName").value;
      db.ref("branding/name").set(name);
      alert("Company name updated!");
    }

    function loadBranding() {
      db.ref("branding/name").once("value", snap => {
        document.getElementById("companyName").value = snap.val() || "";
      });
    }

    function savePrice() {
      const price = document.getElementById("priceInput").value;
      db.ref("price").set(price);
      alert("Price updated!");
    }

    function loadPrice() {
      db.ref("price").once("value", snap => {
        document.getElementById("priceInput").value = snap.val() || "";
      });
    }

    function addQuestion() {
      const text = document.getElementById("qText").value;
      const options = [
        document.getElementById("opt1").value,
        document.getElementById("opt2").value,
        document.getElementById("opt3").value,
        document.getElementById("opt4").value
      ];
      const correct = document.getElementById("correctOpt").value;
      const key = db.ref("questions").push().key;
      db.ref("questions/" + key).set({ text, options, correct });
      alert("Question added!");
      loadQuestions();
    }

    function loadQuestions() {
      db.ref("questions").once("value", snap => {
        const list = document.getElementById("questionList");
        list.innerHTML = "";
        snap.forEach(child => {
          const q = child.val();
          const li = document.createElement("li");
          li.innerHTML = `${q.text} <button onclick="deleteQuestion('${child.key}')">Delete</button>`;
          list.appendChild(li);
        });
      });
    }

    function deleteQuestion(key) {
      if (confirm("Delete this question?")) {
        db.ref("questions/" + key).remove();
        loadQuestions();
      }
    }

    function loadUsers() {
      db.ref("users").once("value", snap => {
        const tbody = document.querySelector("#userTable tbody");
        tbody.innerHTML = "";
        snap.forEach(child => {
          const u = child.val();
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td>${u.name}</td>
            <td>${u.email}</td>
            <td>${u.score}</td>
            <td><button class="btn-danger" onclick="deleteUser('${child.key}')">Delete</button></td>
          `;
          tbody.appendChild(tr);
        });
      });
    }

    function deleteUser(key) {
      if (confirm("Delete this user record?")) {
        db.ref("users/" + key).remove();
        loadUsers();
      }
    }
  </script>
</body>
</html>
